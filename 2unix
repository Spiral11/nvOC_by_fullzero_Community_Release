#!/bin/bash

export NVOC="$( cd "$( dirname "${BASH_SOURCE[0]}" )" && pwd )"

# make log folder, re/mount new one 
mkdir -p "${NVOC}/nvoc_logs"
if ! mountpoint -q "${NVOC}/nvoc_logs"
then
  if sudo mount -t tmpfs -o defaults,noatime,nosuid,nodev,noexec,mode=1777,size=512M nvoc_logs_$(echo ${NVOC} | shasum | head -c 6) ${NVOC}/nvoc_logs
  then
    exit
  fi
fi

# TODO: check 1bash minimum required revision

# TODO: check updates on current git branch, give warning, start pre-fetching in background, do not pull them automatically

bash "${NVOC}/3main"
